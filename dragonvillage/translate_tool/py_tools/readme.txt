# 개요
프로젝트 내 텍스트 추출을 도와주는 번역 추출 툴입니다.
좀 더 자세한 내용은 아래 컨플루언스에서 확인하실 수 있습니다.
https://highbrow.atlassian.net/wiki/spaces/dvm/pages/642613279


# 사용할 코드에 대한 간략한 설명입니다.
1. extract_text.py - 텍스트 추출을 합니다.
2. make_lua.py - 백업시트와 델타시트를 합쳐 루아 테이블 파일을 만듭니다.
3. merge_sheet.py - 백업시트 하단부에 델타시트의 내용을 붙입니다.
* 위 코드들은 공통적으로 config.json 파일에 적혀진 설정을 따릅니다.


# 실행을 위해 필요한 것
1. 파이썬 버전은 3.8.5 버전을 사용합니다.
2. 파이썬 관련 라이브러리를 설치하기 위해 콘솔창에서 아래와 같이 입력합니다.
    2-1. pip install --upgrade oauth2client
    2-2. pip install gspread    
    2-3. pip install PyOpenSSL
3. 번역 툴이 스프레드시트에 접근하기 위해 사용하는 이메일 값을 스프레드시트 접근 권한에 추가해야 합니다.


# 사용 방법
1. config.json 파일을 알맞게 수정합니다.
2. 원하는 기능을 가진 코드를 더블 클릭하여 실행시킵니다.
   실행을 확인하는 문구가 나오면 y 를 입력합니다.
   실행되면 콘솔 창이 뜨고 작업 중 로그를 띄워 현재 상황을 알려줍니다.


# config.json 구성요소
1. locale_list - 번역할 언어를 배열로 담습니다.
2. spreadsheet_id - 구글 스프레드시트의 아이디 값을 담습니다.
3. extract_config - 텍스트 추출 관련 설정 값입니다. 자세한 사항은 컨플루언스 문서를 참고하세요.
    3-1. delta_sheet_name : 델타시트의 이름 값입니다.
    3-2. backup_sheet_name : 백업시트의 이름 값입니다.
    3-3. upload_method : 사용할 업로드 방식 값입니다.
    3-4. sum_data_method : 각 추출 데이터를 전체 데이터에 합칠 때 사용되는 데이터 병합 방식 값입니다.
    3-5. extract_method_list : 각각 텍스트를 어떠한 곳에서 어떠한 방식으로 추출할지 결정하는 정보를 담은 객체 배열입니다.
        3-5-1. name : 로그에 출력될 이름 값입니다.
        3-5-2. src : 추출될 절대 경로 값입니다.
        3-5-3. func : 프로젝트에서 텍스트 추출에 사용될 방법 값입니다.
        3-5-4. ignore_files : 추출에서 제외할 파일 이름 배열입니다.
        3-5-5. ignore_folders : 추출에서 제외할 폴더 이름 배열입니다.
        3-5-6. ignore_krs : 추출에서 제외할 텍스트입니다.
3. lua_table_config - 루아 테이블 생성 관련 설정 값입니다. 자세한 사항은 컨플루언스 문서를 참고하세요.
    3-1. src : 루아 테이블이 생성될 경로입니다.
    3-2. sheet_name_list : 루아 테이블을 생성하기 위해 참조할 워크시트 이름 배열입니다.
    3-3. table_file_name_list : 생성할 루아 테이블의 이름 배열입니다. 이 배열의 크기와 동일하게 루아 테이블 파일이 생성됩니다.
    3-4. key_value_list : 루아 테이블을 생성할 때 사용할 KEY/VALUE 관련 정보를 담은 객체 배열입니다.
        3-4-1. key : KEY로 사용될 컬럼 이름 값입니다.
        3-4-2. value_list : 각 파일마다 VALUE로 사용될 컬럼 이름 값의 배열입니다. 위의 table_file_name_list 순서를 참고하세요.
        3-4-3. replace_list : 만약 각 파일마다 value_list에 해당하는 컬럼에 대한 값이 비어있을 때 값을 찾을 때까지 해당 배열의 값을 차례로 이용하여 VALUE를 채웁니다. 
4. merge_config_list - 워크시트 병합 관련 설정 값입니다. 자세한 사항은 컨플루언스 문서를 참고하세요.
    4-1. delta_sheet_name : 델타시트의 이름 값입니다.
    4-2. backup_sheet_name : 백업시트의 이름 값입니다.
    4-3. merge_method : 백업시트에 델타시트의 데이터를 추가할 때 방법 값입니다.


# 각 코드별 참고 사항
1. extract_text.py
- 새로운 텍스트 추출은 백업시트와의 중복 검사를 통해 걸러집니다. 이미 델타시트가 존재하는 경우 델타시트와 중복 검사 또한 진행합니다. 
- 만약 원하는 대로 잘 추출이 안되는 경우에는 기존 델타시트를 삭제하고 코드를 실행해보세요. 델타시트를 새로 만들어 내용을 채울 것입니다.

2. make_lua.py
- 델타시트와 백업시트의 내용을 합쳐서 루아 테이블을 만들어냅니다. 
- 기존 루아 테이블을 덮어씌우지 않도록 생성 경로를 잘 설정하는 것이 좋습니다.

3. merge_sheet.py 
- 델타시트의 내용을 백업시트 맨 하단에 추가합니다. 이 과정에서는 따로 중복검사를 하지 않고 추가합니다. 따라서 두 번 실행될 경우 중복된 내용이 백업시트에 존재할 수 있으니 주의하세요.

