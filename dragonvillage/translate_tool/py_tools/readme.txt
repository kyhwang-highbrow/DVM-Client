# 개요
프로젝트 내 텍스트 추출을 도와주는 번역 추출 툴입니다.
좀 더 자세한 내용은 아래 컨플루언스에서 확인하실 수 있습니다.
https://highbrow.atlassian.net/wiki/spaces/dvm/pages/642613279


# 사용할 코드에 대한 간략한 설명입니다.
1. extract.py - 일반 텍스트 추출을 합니다. 기존의 백업 시트와 비교하여 중복되지 않는 텍스트만 시트로 작성합니다. 
2. extract_scenario.py - 시나리오 텍스트 추출을 합니다. 기존의 백업 시트와 비교하여 중복되지 않는 텍스트만 시트로 작성합니다.
3. make_lua.py - 기존의 백업 시트와 새로운 시트를 합쳐 루아 테이블 파일을 만듭니다.
4. merge_sheet.py - 기존의 백업 시트 하단부에 새로운 시트의 내용을 붙입니다.

위 코드들은 공통적으로 config.json 파일에 적혀진 설정을 따릅니다.


# 실행을 위해 필요한 것
1. 파이썬 버전은 3.8.5 버전을 사용합니다.
2. 파이썬 관련 라이브러리를 설치하기 위해 콘솔창에서 아래와 같이 입력합니다.
    1. pip install --upgrade oauth2client
    2. pip install gspread
    3. pip install PyOpenSSL
3. 번역 툴이 스프레드시트에 접근하기 위해 사용하는 이메일 값을 스프레드시트 접근 권한에 추가해야 합니다.


# 사용 방법
1. config.json 파일을 알맞게 수정합니다.
2. 원하는 기능을 가진 코드를 더블 클릭하여 실행시킵니다.
   실행을 확인하는 문구가 나오면 y 를 입력합니다.
   실행되면서 콘솔 창이 뜨고 적절한 로그를 중간중간 띄워 진행 상황을 표시합니다.


# config.json 구성요소
1. locale_list - 번역할 언어를 배열로 담습니다.
2. spreadsheet_id - 구글 스프레드시트의 아이디 값을 담습니다.
3. sheet_name_list - 적용할 스프레드시트 내의 워크시트 이름을 배열로 담습니다. 백업시트 이름을 같이 적을 필요 없습니다.
4. plain_text_ignore_files - 일반 텍스트를 추출할 때 무시할 파일 이름을 배열로 담습니다.
5. plain_text_ignore_folders - 일반 텍스트를 추출할 때 무시할 폴더 이름을 배열로 담습니다.
6. scenario_text_ignore_files - 시나리오 텍스트를 추출할 때 무시할 파일 이름을 배열로 담습니다.
7. scenario_text_ignore_folders - 시나리오 텍스트를 추출할 때 무시할 폴더 이름을 배열로 담습니다.


# 각 코드별 참고 사항
1. extract, extract_scenario
- 새로운 텍스트 추출은 백업시트와의 중복 검사를 통해 걸러집니다. 추가로 이미 뉴시트가 존재하는 경우 뉴시트와 중복 검사 또한 진행합니다. 
- 만약 원하는 대로 잘 추출이 안되는 경우에는 기존 뉴시트를 삭제하고 코드를 실행해보세요. 뉴시트를 새로 만들어 내용을 채웁니다.

2. make_lua
- 뉴시트와 백업시트의 내용을 합쳐서 루아 테이블을 만들어냅니다. 기존 루아 테이블을 덮어씌우지 않도록 translation/newLuaTable 폴더 내부에 생성되도록 했습니다.

3. merge_sheet 
- 뉴시트의 내용을 백업시트 맨 하단에 추가합니다. 이 과정에서는 따로 중복검사를 하지 않고 추가합니다. 따라서 두 번 실행될 경우 중복된 내용이 백업시트에 존재할 수 있으니 주의하세요.

