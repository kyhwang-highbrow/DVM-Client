# 개요
프로젝트 내 텍스트 추출을 도와주는 번역 추출 툴입니다.
좀 더 자세한 내용은 아래 컨플루언스에서 확인하실 수 있습니다.
https://highbrow.atlassian.net/wiki/spaces/dvm/pages/642613279


# 사용할 코드에 대한 간략한 설명입니다.
1. extract_text.py - 텍스트를 추출하고 델타시트에 내용을 추가합니다.
2. make_origin_lua.py - 스프레드시트를 이용하여 원본 번역 파일을 만듭니다.
3. make_delta_lua.py -  스프레드시트와 원본 번역 파일을 비교하여 델타 번역 파일을 만듭니다.
4. merge_sheet.py - 백업시트 하단부에 델타시트의 내용을 붙입니다.
* 위 코드들은 공통적으로 config.json 파일에 적혀진 설정을 따릅니다.


# 실행을 위해 필요한 것
1. 코드는 파이썬 버전 3.8.5를 기준으로 작성했습니다. 알맞은 버전을 선택해서 설치해야 합니다.
2. 번역 툴이 스프레드시트에 접근하기 위해 사용하는 이메일 값을 스프레드시트 접근 권한에 추가해야 합니다.


# 사용 방법
1. config.json 파일을 알맞게 수정합니다.
2. 원하는 기능을 가진 코드를 더블 클릭하여 실행시킵니다.
   실행을 확인하는 문구가 나오면 영어 y 를 입력합니다.
   코드를 실행하는 도중에는 관련된 로그를 띄워 상황을 알려줍니다.


# config.json 구성요소
1. locale_list - 번역할 언어를 배열로 담습니다.

2. spreadsheet_id - 구글 스프레드시트의 아이디 값을 담습니다.

3. extract_config - 텍스트 추출 관련 설정 값입니다. 자세한 사항은 컨플루언스 문서를 참고하세요.
    3-1. delta_sheet_name : 델타시트의 이름 값입니다.
    3-2. backup_sheet_name : 백업시트의 이름 값입니다.
    3-3. upload_method : 사용할 업로드 방식 값입니다.
    3-4. sum_data_method : 각 추출 데이터를 전체 데이터에 합칠 때 사용되는 데이터 병합 방식 값입니다.
    3-5. extract_method_list : 각각 텍스트를 어떠한 곳에서 어떠한 방식으로 추출할지 결정하는 정보를 담은 객체 배열입니다.
        3-5-1. name : 로그에 출력될 이름 값입니다.
        3-5-2. src : 추출될 절대 경로 값입니다.
        3-5-3. func : 프로젝트에서 텍스트 추출에 사용될 방법 값입니다.
        3-5-4. ignore_files : 추출에서 제외할 파일 이름 배열입니다.
        3-5-5. ignore_folders : 추출에서 제외할 폴더 이름 배열입니다.
        3-5-6. ignore_krs : 추출에서 제외할 텍스트입니다.

4. origin_lua_table_config - 원본 번역 파일 생성 관련 설정 값입니다. 자세한 사항은 컨플루언스 문서를 참고하세요.
    4-1. make_dir : 원본 번역 파일이 생성될 경로입니다.
    4-2. backup_dir : make_dir에 존재하던 번역 파일을 백업할 경로입니다.
    4-2. sheet_name_list : 원본 번역 파일을 생성하기 위해 참조할 워크시트 이름 배열입니다.
    4-3. make_file_name_list : 생성할 원본 번역 파일의 이름 배열입니다. 이 배열의 크기와 동일하게 원본 번역 파일이 생성됩니다.
    4-4. key_value_list : 번역 파일을 생성할 때 사용할 KEY/VALUE 관련 정보를 담은 객체 배열입니다.
        4-4-1. key : KEY로 사용될 컬럼 이름 값입니다.
        4-4-2. value_list : 각 파일마다 VALUE로 사용될 컬럼 이름 값의 배열입니다. 위의 make_file_name_list 순서와 맞춰주세요.
        4-4-3. replace_list : 만약 각 파일마다 value_list에 해당하는 컬럼에 대한 값이 비어있을 때 값을 찾을 때까지 해당 배열의 값을 차례로 이용하여 VALUE를 채웁니다. 

5. delta_lua_table_config - 델타 번역 파일 생성 관련 설정 값입니다. 자세한 사항은 컨플루언스 문서를 참고하세요.
    5-1. make_dir : 델타 번역 파일이 생성될 경로입니다.
    5-2. compare_dir : 원본 번역 파일을 찾을 경로입니다.
    5-2. sheet_name_list : 델타 번역 파일을 생성하기 위해 참조할 워크시트 이름 배열입니다.
    5-3. make_file_name_list : 생성할 델타 번역 파일의 이름 배열입니다. 이 배열의 크기와 동일하게 원본 번역 파일이 생성됩니다.
    5-4. compare_file_name_list : 비교할 원본 번역 파일의 이름 배열입니다. 위의 make_file_name_list 순서와 맞춰주세요.
    5-5. key_value_list : 번역 파일을 생성할 때 사용할 KEY/VALUE 관련 정보를 담은 객체 배열입니다.
        5-5-1. key : KEY로 사용될 컬럼 이름 값입니다.
        5-5-2. value_list : 각 파일마다 VALUE로 사용될 컬럼 이름 값의 배열입니다. 위의 make_file_name_list 순서와 맞춰주세요.
        5-5-3. replace_list : 만약 각 파일마다 value_list에 해당하는 컬럼에 대한 값이 비어있을 때 값을 찾을 때까지 해당 배열의 값을 차례로 이용하여 VALUE를 채웁니다. 

6. merge_config_list - 워크시트 병합 관련 설정 값입니다. 자세한 사항은 컨플루언스 문서를 참고하세요.
    6-1. delta_sheet_name : 델타시트의 이름 값입니다.
    6-2. backup_sheet_name : 백업시트의 이름 값입니다.
    6-3. merge_method : 백업시트에 델타시트의 데이터를 추가할 때 방법 값입니다.


# 각 코드별 참고 사항
1. extract_text.py
- 새로운 텍스트 추출은 백업시트와의 중복 검사를 통해 걸러집니다. 이미 델타시트가 존재하는 경우 델타시트와 중복 검사 또한 진행합니다. 
- 만약 원하는 대로 잘 추출이 안되는 경우에는 기존 델타시트를 삭제하고 코드를 실행해보세요. 델타시트를 새로 만들어 내용을 채울 것입니다.

2. make_origin_lua.py
- 스프레드시트의 내용을 합쳐서 원본 번역 파일을 만들어냅니다. 
- 기존 번역 파일의 백업 경로를 delta_lua_table_config 설정의 compare_dir 값과 맞춰주시면 좋습니다.

3. make_delta_lua.py
- 스프레드시트와 원본 번역 파일의 내용을 비교하여 델타 번역 파일을 만들어냅니다. 
- 원본 번역 파일의 경로(compare_dir)를 origin_lua_table_config 설정의 backup_dir 값과 맞춰주시면 좋습니다.

4. merge_sheet.py 
- 델타시트의 내용을 백업시트 맨 하단에 추가합니다. 이 과정에서는 따로 중복검사를 하지 않고 추가합니다. 
- 여러번 실행할 경우 중복된 내용이 백업시트에 존재할 수 있으니 주의하세요.


# 사용 예시
1. 코드나 데이터가 업데이트되어 새로운 번역 텍스트를 추출하고 싶을 때
    1-1. extract_text.py 실행

2. 다음 패치를 위한 패치 프로세스
    2-1. 추출한 텍스트에 대한 번역이 완료되면 make_origin_lua.py 실행하여 새로운 원본 번역 파일 생성 및 기존의 원본 번역 파일 백업
    2-2. 게임 내 테스트 후 번역이 문제 없다면 패치를 위해 make_delta_lua.py를 실행하여 델타 번역 파일을 생성(델타 번역 파일은 2-1에서 백업한 원본 번역 파일과 스프레드시트 비교하여 생성됨) 
    2-3. 패치 파일 생성 프로세스 진행하고, 원본 번역 파일이 패치 파일 안에 들어있지 않는지 확인(원본 번역파일은 변화가 있더라도 패치 파일에는 없는게 정상, 다만 델타 번역파일이 있어야 함)
    2-4. 패치 파일에 따로 문제가 없다면 이후에 델타 번역 파일은 삭제해도 문제 없음

3. 패치가 끝나고 번역 시트를 백업으로 합치고 싶을 때
    3-1. merge_sheet.py 실행